<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Algorithm Visualizer</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { 
  background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2e 100%);
  color:#fff; 
  font-family:monospace; 
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:20px;
  min-height:100vh;
}
h1 {
  font-size:2rem;
  margin:20px 0;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing:0.1em;
  text-shadow: 0 0 30px rgba(102,126,234,0.3);
}
.subtitle {
  color: rgba(102,126,234,0.7);
  font-size: 0.9rem;
  margin-bottom: 20px;
  letter-spacing: 0.2em;
}
#status {
  margin:10px;
  padding:10px 20px;
  background:rgba(102,126,234,0.2);
  border:2px solid #667eea;
  border-radius:8px;
  font-size:12px;
  box-shadow: 0 0 20px rgba(102,126,234,0.2);
}
#canvas {
  margin:20px 0;
  border:2px solid #667eea;
  border-radius:10px;
  box-shadow:0 0 30px rgba(102,126,234,0.4);
  background:#0a0a1a;
}
#controls {
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  justify-content:center;
  margin:20px 0;
}
button, select {
  padding:10px 20px;
  background:rgba(102,126,234,0.3);
  border:2px solid #667eea;
  color:#fff;
  border-radius:8px;
  cursor:pointer;
  font-family:monospace;
  font-weight:bold;
  transition:all 0.3s;
  font-size:12px;
}
button:hover, select:hover {
  background:rgba(102,126,234,0.6);
  box-shadow:0 0 20px #667eea;
  transform: translateY(-2px);
}
button:active {
  transform: translateY(0);
}
button:disabled {
  opacity:0.3;
  cursor:not-allowed;
  transform: none;
}
select {
  cursor:pointer;
}
option {
  background:#1a0a2e;
}
.stats {
  display:flex;
  gap:20px;
  margin:10px 0;
  font-size:14px;
  color:rgba(255,255,255,0.7);
}
.stat-item {
  padding:8px 15px;
  background:rgba(0,0,0,0.3);
  border-radius:6px;
  border:1px solid rgba(102,126,234,0.3);
  min-width: 120px;
  text-align: center;
}
.stat-label {
  color:rgba(102,126,234,0.8);
  font-size:11px;
  letter-spacing: 0.1em;
}
.stat-value {
  color:#fff;
  font-size:20px;
  font-weight:bold;
  margin-top: 4px;
}
@media (max-width: 768px) {
  #canvas { width: 100%; height: auto; }
  .stats { flex-wrap: wrap; gap: 10px; }
  h1 { font-size: 1.5rem; }
}
</style>
</head>
<body>

<!-- DEMO_META
title: ALGORITHM VISUALIZER
desc: „ÇΩ„Éº„Éà„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÅÆÂèØË¶ñÂåñ„ÄÇ„Éê„Éñ„É´„Éª„ÇØ„Ç§„ÉÉ„ÇØ„Éª„Éû„Éº„Ç∏„ÉªÊåøÂÖ•„ÉªÈÅ∏Êäû„ÅÆ5Á®ÆÈ°û
tech: JavaScript ¬∑ Canvas 2D ¬∑ Algorithm Visualization ¬∑ Real-time Animation
level: 92
color: #667eea
type: demo
-->

<h1>üìä ALGORITHM VISUALIZER</h1>
<div class="subtitle">SORTING ALGORITHMS ¬∑ REAL-TIME VISUALIZATION</div>
<div id="status">‚úÖ Ready to sort!</div>

<div class="stats">
  <div class="stat-item">
    <div class="stat-label">COMPARISONS</div>
    <div class="stat-value" id="comparisons">0</div>
  </div>
  <div class="stat-item">
    <div class="stat-label">SWAPS</div>
    <div class="stat-value" id="swaps">0</div>
  </div>
  <div class="stat-item">
    <div class="stat-label">TIME</div>
    <div class="stat-value" id="time">0ms</div>
  </div>
</div>

<canvas id="canvas" width="800" height="400"></canvas>

<div id="controls">
  <select id="algorithm">
    <option value="bubble">Bubble Sort</option>
    <option value="quick">Quick Sort</option>
    <option value="merge">Merge Sort</option>
    <option value="insertion">Insertion Sort</option>
    <option value="selection">Selection Sort</option>
  </select>
  
  <select id="size">
    <option value="30">30 elements</option>
    <option value="50" selected>50 elements</option>
    <option value="100">100 elements</option>
    <option value="150">150 elements</option>
  </select>
  
  <select id="speed">
    <option value="1">‚ö° Fast</option>
    <option value="10" selected>‚ñ∂Ô∏è Normal</option>
    <option value="50">üê¢ Slow</option>
    <option value="100">üêå Very Slow</option>
  </select>
  
  <button id="shuffle">üîÄ Shuffle</button>
  <button id="sort">‚ñ∂Ô∏è Sort</button>
  <button id="stop">‚è∏Ô∏è Stop</button>
</div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const W = canvas.width;
const H = canvas.height;

let array = [];
let arraySize = 50;
let delay = 10;
let sorting = false;
let stopRequested = false;
let comparisons = 0;
let swaps = 0;

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function shuffle() {
  arraySize = parseInt(document.getElementById('size').value);
  array = Array.from({length: arraySize}, () => Math.random());
  resetStats();
  draw();
}

function resetStats() {
  comparisons = 0;
  swaps = 0;
  document.getElementById('comparisons').textContent = '0';
  document.getElementById('swaps').textContent = '0';
  document.getElementById('time').textContent = '0ms';
}

function updateStats() {
  document.getElementById('comparisons').textContent = comparisons;
  document.getElementById('swaps').textContent = swaps;
}

function draw(highlights = [], sorted = []) {
  ctx.fillStyle = '#0a0a1a';
  ctx.fillRect(0, 0, W, H);
  
  const barWidth = W / array.length;
  const padding = 1;
  
  for (let i = 0; i < array.length; i++) {
    const barHeight = array[i] * (H - 20);
    const x = i * barWidth;
    const y = H - barHeight;
    
    let color;
    if (highlights.includes(i)) {
      color = '#f472b6'; // Comparing
      ctx.shadowBlur = 15;
      ctx.shadowColor = '#f472b6';
    } else if (sorted.includes(i)) {
      color = '#10b981'; // Sorted
      ctx.shadowBlur = 10;
      ctx.shadowColor = '#10b981';
    } else {
      const hue = 200 + (array[i] * 80);
      color = `hsl(${hue}, 70%, 60%)`;
      ctx.shadowBlur = 0;
    }
    
    ctx.fillStyle = color;
    ctx.fillRect(x + padding, y, barWidth - padding * 2, barHeight);
    ctx.shadowBlur = 0;
  }
}

// ======= SORTING ALGORITHMS =======

async function* bubbleSort(arr) {
  const n = arr.length;
  for (let i = 0; i < n; i++) {
    for (let j = 0; j < n - i - 1; j++) {
      comparisons++;
      yield [j, j+1];
      
      if (arr[j] > arr[j+1]) {
        [arr[j], arr[j+1]] = [arr[j+1], arr[j]];
        swaps++;
        yield [j, j+1];
      }
    }
  }
}

async function* insertionSort(arr) {
  for (let i = 1; i < arr.length; i++) {
    const key = arr[i];
    let j = i - 1;
    
    while (j >= 0) {
      comparisons++;
      yield [j, j+1];
      
      if (arr[j] > key) {
        arr[j+1] = arr[j];
        swaps++;
        yield [j, j+1];
        j--;
      } else {
        break;
      }
    }
    arr[j+1] = key;
  }
}

async function* selectionSort(arr) {
  const n = arr.length;
  for (let i = 0; i < n; i++) {
    let minIdx = i;
    
    for (let j = i + 1; j < n; j++) {
      comparisons++;
      yield [minIdx, j];
      
      if (arr[j] < arr[minIdx]) {
        minIdx = j;
      }
    }
    
    if (minIdx !== i) {
      [arr[i], arr[minIdx]] = [arr[minIdx], arr[i]];
      swaps++;
      yield [i, minIdx];
    }
  }
}

async function* quickSort(arr, low = 0, high = arr.length - 1) {
  if (low < high) {
    const pivot = arr[high];
    let i = low - 1;
    
    for (let j = low; j < high; j++) {
      comparisons++;
      yield [j, high];
      
      if (arr[j] <= pivot) {
        i++;
        if (i !== j) {
          [arr[i], arr[j]] = [arr[j], arr[i]];
          swaps++;
          yield [i, j];
        }
      }
    }
    
    [arr[i+1], arr[high]] = [arr[high], arr[i+1]];
    swaps++;
    yield [i+1, high];
    
    const pi = i + 1;
    yield* quickSort(arr, low, pi - 1);
    yield* quickSort(arr, pi + 1, high);
  }
}

async function* mergeSort(arr, start = 0, end = arr.length - 1) {
  if (start < end) {
    const mid = Math.floor((start + end) / 2);
    
    yield* mergeSort(arr, start, mid);
    yield* mergeSort(arr, mid + 1, end);
    yield* merge(arr, start, mid, end);
  }
}

async function* merge(arr, start, mid, end) {
  const left = arr.slice(start, mid + 1);
  const right = arr.slice(mid + 1, end + 1);
  
  let i = 0, j = 0, k = start;
  
  while (i < left.length && j < right.length) {
    comparisons++;
    yield [start + i, mid + 1 + j];
    
    if (left[i] <= right[j]) {
      arr[k] = left[i];
      i++;
    } else {
      arr[k] = right[j];
      j++;
    }
    swaps++;
    yield [k];
    k++;
  }
  
  while (i < left.length) {
    arr[k] = left[i];
    swaps++;
    yield [k];
    i++;
    k++;
  }
  
  while (j < right.length) {
    arr[k] = right[j];
    swaps++;
    yield [k];
    j++;
    k++;
  }
}

// ======= MAIN SORT FUNCTION =======

async function sort() {
  if (sorting) return;
  
  sorting = true;
  stopRequested = false;
  document.getElementById('sort').disabled = true;
  document.getElementById('shuffle').disabled = true;
  
  const algorithm = document.getElementById('algorithm').value;
  delay = parseInt(document.getElementById('speed').value);
  
  resetStats();
  const startTime = Date.now();
  
  document.getElementById('status').textContent = `‚öôÔ∏è Sorting with ${algorithm} sort...`;
  
  let generator;
  const arrCopy = [...array];
  
  switch(algorithm) {
    case 'bubble':
      generator = bubbleSort(arrCopy);
      break;
    case 'insertion':
      generator = insertionSort(arrCopy);
      break;
    case 'selection':
      generator = selectionSort(arrCopy);
      break;
    case 'quick':
      generator = quickSort(arrCopy);
      break;
    case 'merge':
      generator = mergeSort(arrCopy);
      break;
  }
  
  for await (const highlights of generator) {
    if (stopRequested) break;
    
    array = [...arrCopy];
    draw(highlights);
    updateStats();
    
    await sleep(delay);
  }
  
  const elapsed = Date.now() - startTime;
  document.getElementById('time').textContent = elapsed + 'ms';
  document.getElementById('status').textContent = '‚úÖ Sorting complete!';
  
  // Final animation - show all sorted
  for (let i = 0; i < array.length; i++) {
    if (stopRequested) break;
    draw([], Array.from({length: i+1}, (_, idx) => idx));
    await sleep(5);
  }
  
  draw([], Array.from({length: array.length}, (_, idx) => idx));
  
  sorting = false;
  document.getElementById('sort').disabled = false;
  document.getElementById('shuffle').disabled = false;
}

function stop() {
  stopRequested = true;
  document.getElementById('status').textContent = '‚è∏Ô∏è Stopped';
}

// Event listeners
document.getElementById('shuffle').addEventListener('click', shuffle);
document.getElementById('sort').addEventListener('click', sort);
document.getElementById('stop').addEventListener('click', stop);
document.getElementById('size').addEventListener('change', shuffle);

// Initialize
shuffle();
</script>

</body>
</html>
