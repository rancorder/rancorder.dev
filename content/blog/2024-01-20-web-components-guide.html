<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Qiita/Zenn統合、自動サイトマップ、インタラクティブHTML──30時間で構築した自動化基盤の設計思想と実装。" />

  <title>GitHubにプッシュするだけのブログ量産システム</title>

  <!-- canonical: 仮（本番URLに差し替え） -->
  <link rel="canonical" href="https://example.com/articles/github-push-blog-system" />

  <!-- Open Graph: 必要最小 -->
  <meta property="og:type" content="article" />
  <meta property="og:locale" content="ja_JP" />
  <meta property="og:title" content="GitHubにプッシュするだけのブログ量産システム" />
  <meta property="og:description" content="Qiita/Zenn統合、自動サイトマップ、インタラクティブHTML──30時間で構築した自動化基盤の設計思想と実装。" />
  <meta property="og:url" content="https://example.com/articles/github-push-blog-system" />
  <!-- og:image: 仮（実画像URLに差し替え） -->
  <meta property="og:image" content="https://example.com/og/github-push-blog-system.png" />

  <!-- Twitter: 必要最小 -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="GitHubにプッシュするだけのブログ量産システム" />
  <meta name="twitter:description" content="Qiita/Zenn統合、自動サイトマップ、インタラクティブHTML──30時間で構築した自動化基盤の設計思想と実装。" />
  <meta name="twitter:image" content="https://example.com/og/github-push-blog-system.png" />

  <!-- 構造化データ（Article） -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "GitHubにプッシュするだけのブログ量産システム",
    "datePublished": "2026-01-20",
    "inLanguage": "ja",
    "description": "Qiita/Zenn統合、自動サイトマップ、インタラクティブHTML──30時間で構築した自動化基盤の設計思想と実装。",
    "author": {
      "@type": "Person",
      "name": "rancorder"
    }
  }
  </script>

  <style>
    :root{
      color-scheme: light;
      --bg: #ffffff;
      --fg: #0f172a;
      --muted: #475569;
      --soft: #f1f5f9;
      --soft2:#e2e8f0;
      --border:#cbd5e1;

      --accent:#0f766e;   /* 上品な緑寄り */
      --warn:#b45309;
      --info:#1d4ed8;
      --ok:#166534;
      --crit:#991b1b;

      --radius: 14px;
      --shadow: 0 10px 30px rgba(2, 6, 23, .06);

      --max: 72ch;
      --lh: 1.85;
      --lh-tight: 1.35;

      --space-1: 8px;
      --space-2: 12px;
      --space-3: 16px;
      --space-4: 24px;
      --space-5: 32px;
      --space-6: 48px;
      --space-7: 72px;
    }

    *{ box-sizing: border-box; }
    html{ scroll-behavior: smooth; }
    body{
      margin: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans JP", sans-serif;
      line-height: var(--lh);
      text-rendering: optimizeLegibility;
      -webkit-font-smoothing: antialiased;
    }

    a{
      color: var(--accent);
      text-decoration: underline;
      text-underline-offset: 0.2em;
    }
    a:hover{ text-decoration-thickness: 2px; }
    a:focus-visible, button:focus-visible{
      outline: 3px solid rgba(15,118,110,.35);
      outline-offset: 2px;
      border-radius: 10px;
    }

    .skip-link{
      position: absolute;
      left: -999px;
      top: 8px;
      padding: 10px 12px;
      background: var(--fg);
      color: #fff;
      border-radius: 10px;
      z-index: 1000;
    }
    .skip-link:focus{ left: 8px; }

    header.site{
      border-bottom: 1px solid var(--soft2);
      background: rgba(255,255,255,.8);
      backdrop-filter: blur(6px);
      position: sticky;
      top: 0;
      z-index: 50;
    }

    .wrap{
      width: min(1100px, 100%);
      margin: 0 auto;
      padding: 0 var(--space-4);
    }

    .sitebar{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: var(--space-3);
      padding: 14px 0;
    }

    .brand{
      display: flex;
      gap: 10px;
      align-items: baseline;
      text-decoration: none;
      color: inherit;
    }
    .brand strong{
      font-size: 14px;
      letter-spacing: .02em;
    }
    .brand span{
      font-size: 12px;
      color: var(--muted);
    }

    nav.primary{
      display: flex;
      align-items: center;
      gap: var(--space-2);
      flex-wrap: wrap;
    }

    .pill{
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 10px;
      border: 1px solid var(--soft2);
      border-radius: 999px;
      background: #fff;
      text-decoration: none;
      color: var(--fg);
      font-size: 13px;
      line-height: var(--lh-tight);
    }
    .pill:hover{ border-color: var(--border); }

    .cta{
      display: inline-flex;
      gap: 10px;
      align-items: center;
    }
    .cta a{
      text-decoration: none;
    }
    .btn{
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 9px 12px;
      border-radius: 12px;
      border: 1px solid var(--soft2);
      background: #fff;
      color: var(--fg);
      font-size: 13px;
      line-height: var(--lh-tight);
      white-space: nowrap;
    }
    .btn.primary{
      border-color: rgba(15,118,110,.25);
      background: rgba(15,118,110,.06);
      color: #0b4f49;
    }
    .btn:hover{ border-color: var(--border); }
    .btn.primary:hover{ border-color: rgba(15,118,110,.45); }

    main{
      padding: var(--space-7) 0 var(--space-7);
    }

    article{
      display: grid;
      grid-template-columns: 1fr;
      gap: var(--space-6);
    }

    .hero{
      display: grid;
      gap: var(--space-3);
      padding: var(--space-6);
      border: 1px solid var(--soft2);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      background: linear-gradient(180deg, rgba(15,118,110,.05), rgba(255,255,255,1));
    }

    .kicker{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      color: var(--muted);
      font-size: 13px;
    }

    h1{
      margin: 0;
      font-size: clamp(28px, 3.2vw, 44px);
      line-height: 1.15;
      letter-spacing: -.02em;
    }

    .lead{
      max-width: var(--max);
      margin: 0;
      color: var(--fg);
      font-size: 16px;
    }

    .meta{
      display: flex;
      flex-wrap: wrap;
      gap: 10px 14px;
      color: var(--muted);
      font-size: 13px;
      padding-top: 6px;
    }
    .meta span{
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .layout{
      display: grid;
      grid-template-columns: minmax(0, 1fr) 260px;
      gap: var(--space-6);
      align-items: start;
    }

    @media (max-width: 980px){
      .layout{ grid-template-columns: 1fr; }
      nav.toc{ position: static; }
    }

    .prose{
      max-width: var(--max);
    }

    .prose h2{
      margin: var(--space-7) 0 var(--space-2);
      font-size: 22px;
      line-height: 1.25;
      letter-spacing: -.01em;
    }
    .prose h3{
      margin: var(--space-5) 0 var(--space-2);
      font-size: 17px;
      line-height: 1.35;
    }
    .prose p{
      margin: 0 0 var(--space-3);
      color: var(--fg);
    }
    .prose ul, .prose ol{
      margin: 0 0 var(--space-3);
      padding-left: 1.2em;
    }
    .prose li{ margin: 6px 0; }

    hr{
      border: 0;
      border-top: 1px solid var(--soft2);
      margin: var(--space-6) 0;
    }

    pre{
      margin: var(--space-3) 0 var(--space-4);
      padding: 14px 14px;
      background: #0b1220;
      color: #e5e7eb;
      border-radius: 14px;
      overflow-x: auto;
      box-shadow: 0 10px 20px rgba(2,6,23,.15);
    }
    code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 13px;
      line-height: 1.65;
      tab-size: 2;
    }

    .table-wrap{
      margin: var(--space-3) 0 var(--space-4);
      border: 1px solid var(--soft2);
      border-radius: 14px;
      overflow: hidden;
      background: #fff;
    }
    .table-wrap > div{
      overflow-x: auto;
    }
    table{
      border-collapse: collapse;
      width: 100%;
      min-width: 560px; /* モバイル時の崩れ防止（横スク許容） */
    }
    th, td{
      padding: 12px 12px;
      border-bottom: 1px solid var(--soft2);
      text-align: left;
      vertical-align: top;
      font-size: 14px;
      line-height: 1.55;
    }
    th{
      background: var(--soft);
      font-weight: 700;
    }
    tr:last-child td{ border-bottom: 0; }

    /* ===== Custom elements styling ===== */
    fade-in{ display:block; }
    fade-in[data-fx="fade"]{
      opacity: 0.001;
      transform: translateY(10px);
      transition: opacity 420ms ease, transform 420ms ease;
      will-change: opacity, transform;
    }
    fade-in[data-fx="fade"].is-visible{
      opacity: 1;
      transform: translateY(0);
    }

    callout-box{
      display: block;
      margin: var(--space-3) 0 var(--space-4);
      border-radius: 14px;
      border: 1px solid var(--soft2);
      background: #fff;
      overflow: hidden;
    }
    .callout{
      padding: 14px 14px 14px 14px;
      border-left: 6px solid var(--border);
      background: linear-gradient(180deg, rgba(241,245,249,.9), rgba(255,255,255,1));
    }
    .callout__title{
      display: flex;
      align-items: baseline;
      gap: 10px;
      font-weight: 800;
      margin: 0 0 8px;
      line-height: var(--lh-tight);
    }
    .callout__title small{
      font-weight: 600;
      color: var(--muted);
    }
    .callout__body{
      margin: 0;
      color: var(--fg);
    }
    .callout[data-type="info"]{ border-left-color: rgba(29,78,216,.55); }
    .callout[data-type="success"]{ border-left-color: rgba(22,101,52,.55); }
    .callout[data-type="warning"]{ border-left-color: rgba(180,83,9,.55); }
    .callout[data-type="critical"]{ border-left-color: rgba(153,27,27,.55); }

    /* ===== TOC ===== */
    nav.toc{
      position: sticky;
      top: 86px;
      border: 1px solid var(--soft2);
      border-radius: var(--radius);
      padding: var(--space-3);
      background: #fff;
      box-shadow: 0 10px 24px rgba(2,6,23,.04);
    }
    nav.toc h2{
      font-size: 13px;
      margin: 0 0 10px;
      color: var(--muted);
      letter-spacing: .02em;
    }
    nav.toc ol{
      margin: 0;
      padding-left: 1.2em;
    }
    nav.toc a{
      font-size: 13px;
      color: var(--fg);
      text-decoration: none;
    }
    nav.toc a:hover{
      text-decoration: underline;
      text-underline-offset: 0.2em;
    }

    footer.site-footer{
      border-top: 1px solid var(--soft2);
      padding: var(--space-5) 0;
      color: var(--muted);
      font-size: 13px;
    }

    .end-links{
      display: grid;
      gap: 10px;
      margin-top: var(--space-3);
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      html{ scroll-behavior: auto; }
      fade-in[data-fx="fade"]{
        transition: none;
        transform: none;
        opacity: 1;
      }
    }
  </style>
</head>

<body>
  <a class="skip-link" href="#main">本文へスキップ</a>

  <header class="site">
    <div class="wrap">
      <div class="sitebar">
        <a class="brand" href="#" aria-label="ホーム（仮）">
          <strong>rancorder.dev</strong>
          <span>記事</span>
        </a>

        <nav class="primary" aria-label="Primary">
          <a class="pill" href="#why">なぜ必要か</a>
          <a class="pill" href="#core">設計思想</a>
          <a class="pill" href="#stack">技術スタック</a>
          <a class="pill" href="#automation">自動化機構</a>
          <a class="pill" href="#roi">投資対効果</a>
          <a class="pill" href="#summary">まとめ</a>
        </nav>

        <div class="cta">
          <a class="btn" href="https://rancorder.vercel.app" rel="noopener">Live</a>
          <a class="btn primary" href="https://github.com/rancorder/portfolio-react-enterprise" rel="noopener">GitHub</a>
        </div>
      </div>
    </div>
  </header>

  <main id="main" class="wrap">
    <article aria-labelledby="article-title">

      <header class="hero">
        <div class="kicker">
          <span>カテゴリ：技術プロジェクト管理</span>
          <span>・</span>
          <span>2026-01-20</span>
          <span>・</span>
          <span>14 min read</span>
        </div>

        <fade-in>
          <h1 id="article-title">GitHubにプッシュするだけのブログ量産システム</h1>
          <p class="lead"><strong>Qiita/Zenn統合、自動サイトマップ、インタラクティブHTML──30時間で構築した自動化基盤</strong></p>
        </fade-in>

        <div class="meta" aria-label="記事メタ情報">
          <span>目的：公開までの摩擦を最小化</span>
          <span>成果：2-3分で公開</span>
          <span>設計：個人依存の排除</span>
        </div>
      </header>

      <div class="layout">
        <div class="prose" id="content">

          <!-- ===== セクション：なぜ必要か ===== -->
          <section id="why" aria-labelledby="h-why">
            <fade-in>
              <h2 id="h-why">なぜこのシステムが必要だったのか</h2>
              <p>
                私は17年間、製造業でエンタープライズPMとして「技術的に完成したPoC」を「安定稼働するProduction」に移行させる仕事をしてきた。
                そこで学んだ最も重要な原則は、<strong>「個人の努力に依存しない構造を作る」</strong>ということだ。
              </p>
            </fade-in>

            <fade-in delay="200">
              <h3>コンテンツ発信の構造的課題</h3>
              <ul>
                <li><strong>プラットフォームが分散</strong>：Qiita、Zenn、個人ブログ、note...</li>
                <li><strong>転載の手間</strong>：複数サイトにコピペ</li>
                <li><strong>SEO効果の分散</strong></li>
                <li><strong>運用負荷</strong>：サイトマップ更新、インデックス管理、デザイン調整...</li>
              </ul>
            </fade-in>

            <fade-in delay="200">
              <callout-box type="warning" title="よくある失敗パターン">
                「技術ブログを始めよう！」→ WordPressセットアップ → プラグイン設定に2日 → デザイン調整に3日 → 疲れて記事を書かない → 放置
              </callout-box>
            </fade-in>

            <fade-in delay="200">
              <p>私が求めていたのは、<strong>「思考から公開まで」の摩擦をゼロにするシステム</strong>だった。</p>

              <pre><code>理想のフロー:
アイデア → HTML作成 → GitHub push → 2-3分で公開完了
                        ↑
                   摩擦がほぼゼロ</code></pre>
            </fade-in>
          </section>

          <hr />

          <!-- ===== セクション：設計思想 ===== -->
          <section id="core" aria-labelledby="h-core">
            <fade-in>
              <h2 id="h-core">アイデアの核心：3つの設計思想</h2>
            </fade-in>

            <fade-in delay="200">
              <h3>1. 外部プラットフォームを「読み込む」発想</h3>

              <callout-box type="success" title="発想の転換">
                <strong>書く場所は自由。でも、すべてを1箇所に集約して見せる。</strong><br />
                Qiitaに書いてもいい。Zennに書いてもいい。でも、私のサイトにアクセスすれば全ての記事が見える。
              </callout-box>

              <ul>
                <li>各プラットフォームの読者層にリーチ</li>
                <li>自サイトでSEO効果を統合</li>
                <li>ポートフォリオとしての完全性を確保</li>
              </ul>
            </fade-in>

            <fade-in delay="200">
              <h3>2. 自動化できるものは全て自動化</h3>
              <p><strong>手動でやることは、いずれやらなくなる。</strong></p>

              <div class="table-wrap" role="region" aria-label="従来の手動作業とこのシステムの比較（横スクロール可能）">
                <div>
                  <table>
                    <thead>
                      <tr><th>従来の手動作業</th><th>このシステム</th></tr>
                    </thead>
                    <tbody>
                      <tr><td>記事インデックスの更新</td><td>HTMLファイルを置くだけで自動検出</td></tr>
                      <tr><td>サイトマップ生成</td><td>ビルド時に自動生成</td></tr>
                      <tr><td>外部記事の転載</td><td>prebuildで自動取得・統合</td></tr>
                      <tr><td>デプロイ作業</td><td>GitHub push → Vercel自動デプロイ</td></tr>
                      <tr><td>メタデータ設定</td><td>Frontmatterに書くだけ</td></tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </fade-in>

            <fade-in delay="200">
              <callout-box type="info" title="自動化の本質">
                自動化の目的は「楽をすること」ではない。<strong>「書く」ことに100%集中するため</strong>だ。
              </callout-box>
            </fade-in>

            <fade-in delay="200">
              <h3>3. インタラクティブ性を標準装備</h3>
              <ul>
                <li>スクロール連動フェードイン</li>
                <li>強調ボックス</li>
                <li>チェックリスト</li>
                <li>比較表</li>
              </ul>
            </fade-in>
          </section>

          <hr />

          <!-- ===== セクション：技術スタック ===== -->
          <section id="stack" aria-labelledby="h-stack">
            <fade-in>
              <h2 id="h-stack">採用した技術スタックとその理由</h2>
            </fade-in>

            <fade-in delay="200">
              <h3>Next.js 14 (App Router)</h3>
              <ul>
                <li>Server/Client Componentsの明確な分離</li>
                <li>ファイルベースルーティング</li>
                <li>ISR</li>
                <li>Vercelとの統合</li>
              </ul>

              <callout-box type="success" title="重要な判断">
                Pages RouterではなくApp Routerを採用。
              </callout-box>
            </fade-in>

            <fade-in delay="200">
              <h3>HTML</h3>
              <pre><code>&lt;CalloutBox type="warning" title="注意"&gt;
ここに重要な警告を書く
&lt;/CalloutBox&gt;</code></pre>
            </fade-in>

            <fade-in delay="200">
              <h3>Prebuild Cache System</h3>
              <pre><code>{
  "scripts": {
    "prebuild": "node scripts/fetch-external-articles.js",
    "build": "next build"
  }
}</code></pre>
            </fade-in>

            <fade-in delay="200">
              <callout-box type="info" title="技術的ポイント">
                Vercelのビルド時制約を「prebuildフック」で回避。
              </callout-box>
            </fade-in>

            <fade-in delay="200">
              <h3>TypeScript + CSS Modules</h3>
              <ul>
                <li>型安全性</li>
                <li>スタイル衝突回避</li>
                <li>IDE補完</li>
              </ul>
            </fade-in>
          </section>

          <hr />

          <!-- ===== セクション：自動化機構 ===== -->
          <section id="automation" aria-labelledby="h-auto">
            <fade-in>
              <h2 id="h-auto">実装の工夫：4つの自動化機構</h2>
            </fade-in>

            <fade-in delay="200">
              <h3>1. 自動インデックスシステム</h3>
              <pre><code>export async function getAllPosts() {
  const files = fs.readdirSync(BLOG_DIR);
  return files
    .filter(f =&gt; f.endsWith('.mdx'))
    .map(file =&gt; {
      const content = fs.readFileSync(path.join(BLOG_DIR, file));
      const { data } = matter(content);
      return { slug: file.replace('.mdx', ''), ...data };
    });
}</code></pre>
            </fade-in>

            <fade-in delay="200">
              <h3>2. 外部記事統合（Qiita/Zenn）</h3>
              <pre><code>async function fetchExternalArticles() {
  const qiita = await fetch(...).then(r =&gt; r.json());
  const zenn = await fetch(...).then(r =&gt; r.json());
  fs.writeFileSync(
    'public/external-articles.json',
    JSON.stringify([...qiita, ...zenn])
  );
}</code></pre>
            </fade-in>

            <fade-in delay="200">
              <callout-box type="success" title="拡張性の高さ">
                新しいプラットフォーム追加も容易。
              </callout-box>
            </fade-in>

            <fade-in delay="200">
              <h3>3. サイトマップ自動生成</h3>
              <pre><code>export default async function sitemap() {
  const posts = await getAllPosts();
  const external = await getExternalArticles();
  return [...];
}</code></pre>
            </fade-in>

            <fade-in delay="200">
              <h3>4. インタラクティブHTMLコンポーネント</h3>
              <ul>
                <li>FadeIn</li>
                <li>CalloutBox</li>
                <li>PoCTimeline</li>
                <li>DecisionFlow</li>
                <li>ComparisonCard</li>
                <li>InteractiveChecklist</li>
              </ul>
            </fade-in>
          </section>

          <hr />

          <!-- ===== セクション：ROI ===== -->
          <section id="roi" aria-labelledby="h-roi">
            <fade-in>
              <h2 id="h-roi">得られた価値：投資対効果</h2>
            </fade-in>

            <fade-in delay="200">
              <h3>開発コスト vs 得られた価値</h3>

              <div class="table-wrap" role="region" aria-label="開発コストと価値の比較（横スクロール可能）">
                <div>
                  <table>
                    <thead>
                      <tr><th>指標</th><th>従来</th><th>このシステム</th></tr>
                    </thead>
                    <tbody>
                      <tr><td>記事公開までの時間</td><td>数時間〜数日</td><td>2-3分</td></tr>
                      <tr><td>プラットフォーム横断作業</td><td>手動転載</td><td>自動統合</td></tr>
                      <tr><td>サイトマップ更新</td><td>手動</td><td>自動</td></tr>
                      <tr><td>SEO管理</td><td>分散</td><td>一元化</td></tr>
                      <tr><td>運用コスト</td><td>継続発生</td><td>ほぼゼロ</td></tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </fade-in>

            <fade-in delay="200">
              <h3>技術的な学び</h3>
              <ul>
                <li>App Router採用は正解</li>
                <li>prebuild cacheでAPI制約回避</li>
                <li>HTMLで表現力確保</li>
                <li>CSS Modulesで安定化</li>
              </ul>
            </fade-in>
          </section>

          <hr />

          <!-- ===== セクション：まとめ ===== -->
          <section id="summary" aria-labelledby="h-sum">
            <fade-in>
              <h2 id="h-sum">このシステムの本質的価値</h2>
            </fade-in>

            <fade-in delay="200">
              <p><strong>これは「思考の外部化と発信を最小限の摩擦で実現するプラットフォーム」だ。</strong></p>
            </fade-in>

            <fade-in delay="200">
              <callout-box type="critical" title="製造業17年から学んだ設計哲学">
                <ol>
                  <li>個人依存を排除</li>
                  <li>自動化できるものは全て自動化</li>
                  <li>摩擦を最小化</li>
                </ol>
              </callout-box>
            </fade-in>

            <fade-in delay="200">
              <h3>今後の拡張可能性</h3>
              <ul>
                <li>タグフィルタ</li>
                <li>全文検索</li>
                <li>コメント</li>
                <li>アナリティクス</li>
              </ul>
            </fade-in>

            <fade-in delay="200">
              <h2>まとめ：アイデアから生まれた価値</h2>
              <ul>
                <li>外部プラットフォームを読み込む</li>
                <li>全自動化</li>
                <li>インタラクティブ性</li>
              </ul>
            </fade-in>

            <fade-in delay="200">
              <callout-box type="success" title="最も重要な価値">
                <strong>「書く」ことに100%集中できる環境を手に入れた。</strong>
              </callout-box>
            </fade-in>

            <fade-in delay="200">
              <p class="end-links">
                <span><strong>GitHub:</strong> <a href="https://github.com/rancorder/portfolio-react-enterprise" rel="noopener">rancorder/portfolio-react-enterprise</a></span>
                <span><strong>Live:</strong> <a href="https://rancorder.vercel.app" rel="noopener">https://rancorder.vercel.app</a></span>
              </p>
            </fade-in>
          </section>

        </div>

        <!-- 右カラム：目次 -->
        <nav class="toc" aria-label="目次">
          <h2>CONTENTS</h2>
          <ol id="toc-list">
            <!-- JSで自動生成（JS無効でもナビ自体は害にならない） -->
          </ol>
        </nav>
      </div>
    </article>
  </main>

  <footer class="site-footer">
    <div class="wrap">
      <div>© rancorder. Built for readability, performance, and long-term maintenance.</div>
      <div style="margin-top:8px;">※ canonical / og:image は仮設定です。公開URLに差し替えてください。</div>
    </div>
  </footer>

  <script>
  (() => {
    'use strict';

    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    /** =========================
     *  CalloutBox: 軽量A11y整形
     *  - title/typeを可視化
     *  - role note（alertは使わない）
     * ========================= */
    const enhanceCallouts = () => {
      const nodes = document.querySelectorAll('callout-box');
      nodes.forEach((el) => {
        if (el.dataset.enhanced === '1') return;

        const type = (el.getAttribute('type') || 'info').toLowerCase();
        const title = el.getAttribute('title') || 'Note';

        // role: 読書中に割り込まない
        if (!el.hasAttribute('role')) el.setAttribute('role', 'note');

        // 既存の内容を保持して包む
        const body = document.createElement('div');
        body.className = 'callout__body';
        while (el.firstChild) body.appendChild(el.firstChild);

        const inner = document.createElement('div');
        inner.className = 'callout';
        inner.dataset.type = type;

        const h = document.createElement('div');
        h.className = 'callout__title';
        h.innerHTML = `<span>${escapeHtml(title)}</span><small>${type.toUpperCase()}</small>`;

        inner.appendChild(h);
        inner.appendChild(body);

        el.appendChild(inner);
        el.dataset.enhanced = '1';
      });
    };

    /** =========================
     * FadeIn: IntersectionObserver
     * - 余計なdelayで読書を遅くしないため上限を設ける
     * ========================= */
    const enhanceFadeIn = () => {
      const items = document.querySelectorAll('fade-in');
      items.forEach((el) => {
        // reduced motionでは効果を付けない（読みやすさ優先）
        if (prefersReducedMotion) return;

        el.dataset.fx = 'fade';

        // delay属性は存在しても「読書の邪魔にならない」上限を設ける
        const raw = Number(el.getAttribute('delay') || '0');
        const clamped = Number.isFinite(raw) ? Math.max(0, Math.min(raw, 250)) : 0;
        el.style.transitionDelay = clamped ? `${clamped}ms` : '0ms';
      });

      if (prefersReducedMotion) return;

      const io = new IntersectionObserver((entries) => {
        entries.forEach((e) => {
          if (!e.isIntersecting) return;
          e.target.classList.add('is-visible');
          io.unobserve(e.target);
        });
      }, { root: null, rootMargin: '0px 0px -10% 0px', threshold: 0.15 });

      items.forEach((el) => io.observe(el));
    };

    /** =========================
     * TOC: h2から自動生成
     * - JSなしでも本文は読める
     * ========================= */
    const buildTOC = () => {
      const list = document.getElementById('toc-list');
      if (!list) return;

      const headings = document.querySelectorAll('#content h2[id]');
      const frag = document.createDocumentFragment();

      headings.forEach((h) => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = `#${h.id}`;
        a.textContent = h.textContent.trim();
        li.appendChild(a);
        frag.appendChild(li);
      });

      list.innerHTML = '';
      list.appendChild(frag);
    };

    const escapeHtml = (s) =>
      String(s).replace(/[&<>"']/g, (c) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));

    // init
    enhanceCallouts();
    enhanceFadeIn();
    buildTOC();
  })();
  </script>
</body>
</html>
